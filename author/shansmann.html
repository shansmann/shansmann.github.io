<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>dsblog - shansmann</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">dsblog </a></h1>
                <nav><ul>
                    <li><a href="/category/python.html">Python</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/RankedDSPrograms.html">Ranked DataScience Programs</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-06-19T10:20:00+02:00">
                Published: Sun 19 June 2016
        </abbr>
		<br />
        <abbr class="modified" title="2016-06-19T19:30:00+02:00">
                Updated: Sun 19 June 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/shansmann.html">shansmann</a>
        </address>
<p>In <a href="/category/python.html">Python</a>.</p>
<p>tags: <a href="/tag/datawrangling.html">DataWrangling</a> </p>
</footer><!-- /.post-info --><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">re</span> <span class="c1">#regex</span>
<span class="kn">from</span> <span class="nn">difflib</span> <span class="kn">import</span> <span class="n">SequenceMatcher</span> <span class="k">as</span> <span class="n">SM</span> <span class="c1">#string comparison</span>
</pre></div>


<h2>Preprocessing</h2>
<div class="highlight"><pre><span></span><span class="n">cwur</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/sebastianhansmann/Documents/Code/kaggle/university/cwurData.csv&#39;</span><span class="p">)</span>
<span class="n">shanghai</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/sebastianhansmann/Documents/Code/kaggle/university/shanghaiData.csv&#39;</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/sebastianhansmann/Documents/Code/kaggle/university/timesData.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">cwur</span> <span class="o">=</span> <span class="n">cwur</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;institution&#39;</span><span class="p">:</span> <span class="s1">&#39;university_name&#39;</span><span class="p">})</span>
<span class="n">shanghai</span> <span class="o">=</span> <span class="n">shanghai</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;total_score&#39;</span><span class="p">:</span> <span class="s1">&#39;score&#39;</span><span class="p">})</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">times</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;total_score&#39;</span><span class="p">:</span> <span class="s1">&#39;score&#39;</span><span class="p">})</span>
</pre></div>


<p>only use total score for the time being</p>
<div class="highlight"><pre><span></span><span class="n">cwur</span> <span class="o">=</span> <span class="n">cwur</span><span class="p">[[</span><span class="s1">&#39;university_name&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]]</span>
<span class="n">shanghai</span> <span class="o">=</span> <span class="n">shanghai</span><span class="p">[[</span><span class="s1">&#39;university_name&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">times</span><span class="p">[[</span><span class="s1">&#39;university_name&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">]]</span>
</pre></div>


<p>pd.to_numeric will cast '-' to 100, therefore we gotta clean it beforhand</p>
<div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="n">times</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">)]</span>
</pre></div>


<p>convert scores to floats</p>
<div class="highlight"><pre><span></span><span class="n">cwur</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">cwur</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">shanghai</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">shanghai</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">times</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">shanghai</span><span class="o">.</span><span class="n">score</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
</pre></div>


<p>group scores from different years by university</p>
<div class="highlight"><pre><span></span><span class="n">cwur</span> <span class="o">=</span> <span class="n">cwur</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;university_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">shanghai</span> <span class="o">=</span> <span class="n">shanghai</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;university_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">times</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;university_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>


<p>creating some visualizations of score distributions to check whether a organization uses a different scala for the total score</p>
<div class="highlight"><pre><span></span><span class="n">scores_cwur</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cwur</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">scores_shanghai</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shanghai</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">scores_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">times</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">scores_cwur</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> 
                                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cwur&#39;</span><span class="p">)</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">scores_shanghai</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span>
                                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Shanghai&#39;</span><span class="p">)</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">scores_times</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">,</span> 
                                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Times&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="output_14_0.png" /></p>
<div class="highlight"><pre><span></span><span class="n">boxplt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">scores_cwur</span><span class="p">,</span> <span class="n">scores_shanghai</span><span class="p">,</span> <span class="n">scores_times</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Cwur&#39;</span><span class="p">,</span> <span class="s1">&#39;Shanghai&#39;</span><span class="p">,</span> <span class="s1">&#39;Times&#39;</span><span class="p">])</span>
</pre></div>


<p><img alt="png" src="output_15_0.png" /></p>
<p>looks like Shanghai &amp; Times do have a different scala than Cwur has thus we should standardize those</p>
<div class="highlight"><pre><span></span><span class="n">cwur</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">cwur</span><span class="o">.</span><span class="n">score</span> <span class="o">-</span> <span class="n">cwur</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">cwur</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">shanghai</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">shanghai</span><span class="o">.</span><span class="n">score</span> <span class="o">-</span> <span class="n">shanghai</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">shanghai</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">times</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">times</span><span class="o">.</span><span class="n">score</span> <span class="o">-</span> <span class="n">times</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">times</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">z_scores_cwur</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cwur</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">z_scores_shanghai</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shanghai</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="n">z_scores_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">times</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">boxplt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">z_scores_cwur</span><span class="p">,</span> <span class="n">z_scores_shanghai</span><span class="p">,</span> <span class="n">z_scores_times</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Cwur&#39;</span><span class="p">,</span> <span class="s1">&#39;Shanghai&#39;</span><span class="p">,</span> <span class="s1">&#39;Times&#39;</span><span class="p">])</span>
</pre></div>


<p><img alt="png" src="output_19_0.png" /></p>
<p>way better, now we can try to merge those datasets: I'll start by cleaning the university_name string</p>
<div class="highlight"><pre><span></span><span class="n">cwur</span><span class="o">.</span><span class="n">university_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&#39;[^a-zA-Z\s0-9]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">cwur</span><span class="o">.</span><span class="n">university_name</span><span class="p">]</span>
<span class="n">shanghai</span><span class="o">.</span><span class="n">university_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&#39;[^a-zA-Z\s0-9]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">shanghai</span><span class="o">.</span><span class="n">university_name</span><span class="p">]</span>
<span class="n">times</span><span class="o">.</span><span class="n">university_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&#39;[^a-zA-Z\s0-9]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">university_name</span><span class="p">]</span>
</pre></div>


<h2>Merging datasets</h2>
<p>can't use SeatGeek's great <a href="https://github.com/seatgeek/fuzzywuzzy">string matching module</a> due to the use of kaggle scripts, gonna start by using built in SequenceMatcher</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_fuzzy_match</span><span class="p">(</span><span class="n">string1</span><span class="p">,</span> <span class="n">string2</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">):</span>
    <span class="n">similarity</span> <span class="o">=</span> <span class="n">SM</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">string1</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">string2</span><span class="p">))</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">similarity</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
</pre></div>


<p>identifying the organization with the most universities present, gonna use that as a starting point</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cwur</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">shanghai</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>(1024, 658, 261)
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">cwur</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;score&#39;</span><span class="p">:</span> <span class="s1">&#39;score_cwur&#39;</span><span class="p">})</span>
</pre></div>


<p>note: not that pretty, gonna refactor those functions later on:</p>
<ul>
<li>more flexibility</li>
<li>using the country as an additional parameter</li>
<li>calculating stats for matching</li>
</ul>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_for_uni_shanghai</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">university</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">uni</span> <span class="ow">in</span> <span class="n">shanghai</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">is_fuzzy_match</span><span class="p">(</span><span class="n">university</span><span class="p">,</span> <span class="n">uni</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">shanghai</span><span class="p">[</span><span class="n">shanghai</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">uni</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#print(&#39;found no match for {u}&#39;.format(u = university))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_for_uni_times</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">university</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">uni</span> <span class="ow">in</span> <span class="n">times</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">is_fuzzy_match</span><span class="p">(</span><span class="n">university</span><span class="p">,</span> <span class="n">uni</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">times</span><span class="p">[</span><span class="n">times</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">uni</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#print(&#39;found no match for {u}&#39;.format(u = university))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;score_shanghai&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_for_uni_shanghai</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;score_times&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_for_uni_times</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>


<p>litte data validation by comparing scores for 'Hardvard University'</p>
<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">university_name</span> <span class="o">==</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">]</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>university_name</th>
      <th>score_cwur</th>
      <th>score_shanghai</th>
      <th>score_times</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>184</th>
      <td>Harvard University</td>
      <td>9.184015</td>
      <td>5.038545</td>
      <td>4.299896</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="n">cwur</span><span class="p">[</span><span class="n">cwur</span><span class="o">.</span><span class="n">university_name</span> <span class="o">==</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
 <span class="n">shanghai</span><span class="p">[</span><span class="n">shanghai</span><span class="o">.</span><span class="n">university_name</span> <span class="o">==</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
 <span class="n">times</span><span class="p">[</span><span class="n">times</span><span class="o">.</span><span class="n">university_name</span> <span class="o">==</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>(9.184014692467624, 5.0385449762130312, 4.2998958193265331)
</pre></div>


<p>now we are going to calc mean scores per row:
note that universities shouldn't be punsihed for not having a score, therefore only not nan values are relevant</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calcScore</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mean_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calcScore</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean_score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;aggregatedScores.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>


<h2>Adding DS programs</h2>
<p>props to Ryan Swanstrom for <a href="https://github.com/ryanswanstrom/awesome-datascience-colleges/blob/master/data_science_colleges.csv">this</a> awesome collection!! For more information see his <a href="https://github.com/ryanswanstrom/">github</a> </p>
<p>cause working in kaggle scripts I only exported university names which have a ds program:</p>
<div class="highlight"><pre><span></span><span class="n">programs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Auburn University&#39;</span><span class="p">,</span> <span class="s1">&#39;The University of Alabama&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Arkansas Tech University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Arkansas&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Arkansas at Little Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;Arizona State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Arizona&#39;</span><span class="p">,</span> <span class="s1">&#39;California Polytechnic State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;California State UniversityEast Bay&#39;</span><span class="p">,</span>
       <span class="s1">&#39;California State UniversityFullerton&#39;</span><span class="p">,</span>
       <span class="s1">&#39;California State UniversityLong Beach&#39;</span><span class="p">,</span>
       <span class="s1">&#39;California State UniversitySan Bernardino&#39;</span><span class="p">,</span> <span class="s1">&#39;Chapman University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Claremont Graduate University&#39;</span><span class="p">,</span> <span class="s1">&#39;Galvanize U&#39;</span><span class="p">,</span>
       <span class="s1">&#39;National University&#39;</span><span class="p">,</span> <span class="s1">&#39;San Jose State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Santa Clara University&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of California Hastings College of Law&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of CaliforniaDavis&#39;</span><span class="p">,</span> <span class="s1">&#39;University of CaliforniaIrvine&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of CaliforniaSan Diego&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of CaliforniaBerkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;University of San Francisco&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Southern California&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of the Pacific&#39;</span><span class="p">,</span> <span class="s1">&#39;American Sentinel University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Aspen University&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado State UniversityFort Collins&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Colorado State UniversityGlobal Campus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Colorado Technical University&#39;</span><span class="p">,</span> <span class="s1">&#39;Regis University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Colorado Boulder&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Colorado Denver&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Denver&#39;</span><span class="p">,</span> <span class="s1">&#39;Central Connecticut State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Quinnipiac University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Connecticut&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of New Haven&#39;</span><span class="p">,</span> <span class="s1">&#39;American University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;George Washington University&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgetown University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The George Washington University&#39;</span><span class="p">,</span> <span class="s1">&#39;New College of Florida&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Florida International University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Florida Polytechnic University&#39;</span><span class="p">,</span> <span class="s1">&#39;Full Sail University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Nova Southeastern University&#39;</span><span class="p">,</span> <span class="s1">&#39;PascoHernando State College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Central Florida&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Florida&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Miami&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of South Florida SarasotaManatee&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of South FloridaMain Campus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Georgia Southern University&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Georgia Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Kennesaw State University&#39;</span><span class="p">,</span> <span class="s1">&#39;Mercer University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Georgia&#39;</span><span class="p">,</span> <span class="s1">&#39;Loras College&#39;</span><span class="p">,</span> <span class="s1">&#39;Northwestern College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Luther College&#39;</span><span class="p">,</span> <span class="s1">&#39;The University of Iowa&#39;</span><span class="p">,</span> <span class="s1">&#39;Aurora University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Benedictine University&#39;</span><span class="p">,</span> <span class="s1">&#39;DePaul University&#39;</span><span class="p">,</span> <span class="s1">&#39;Elmhurst College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Illinois Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Lewis University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Loyola University Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Northwestern University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Illinois at Chicago&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Illinois at Springfield&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Illinois at UrbanaChampaign&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of St Francis&#39;</span><span class="p">,</span> <span class="s1">&#39;Indiana University Bloomington&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Indiana UniversityPurdue UniversityIndianapolis&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Purdue UniversityMain Campus&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Marys College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Notre Dame&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Evansville&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Kansas&#39;</span><span class="p">,</span> <span class="s1">&#39;Northern Kentucky University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Louisville&#39;</span><span class="p">,</span> <span class="s1">&#39;Louisiana State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Babson College&#39;</span><span class="p">,</span> <span class="s1">&#39;Becker College&#39;</span><span class="p">,</span> <span class="s1">&#39;Bentley University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Brandeis University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Northeastern University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Massachusetts Amherst&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Worcester Polytechnic Institute&#39;</span><span class="p">,</span> <span class="s1">&#39;Smith College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Johns Hopkins University&#39;</span><span class="p">,</span> <span class="s1">&#39;Notre Dame of Maryland University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of MarylandBaltimore County&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of MarylandCollege Park&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of MarylandUniversity College&#39;</span><span class="p">,</span> <span class="s1">&#39;Baker College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Central Michigan University&#39;</span><span class="p">,</span> <span class="s1">&#39;Davenport University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Eastern Michigan University&#39;</span><span class="p">,</span> <span class="s1">&#39;Grand Valley State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Michigan State University&#39;</span><span class="p">,</span> <span class="s1">&#39;Michigan Technological University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Oakland University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of MichiganAnn Arbor&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of MichiganDearborn&#39;</span><span class="p">,</span> <span class="s1">&#39;Capella University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The College of Saint Scholastica&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Minnesota&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of MinnesotaDuluth&#39;</span><span class="p">,</span> <span class="s1">&#39;University of St Thomas&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Winona State University&#39;</span><span class="p">,</span> <span class="s1">&#39;Grantham University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Missouri University of Science and Technology&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Rockhurst University&#39;</span><span class="p">,</span> <span class="s1">&#39;Saint Louis University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Saint Louis UniversityMain Campus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of MissouriSt Louis&#39;</span><span class="p">,</span> <span class="s1">&#39;Jackson State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Montana&#39;</span><span class="p">,</span> <span class="s1">&#39;Elon University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;North Carolina State University at Raleigh&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of North Carolina at Chapel Hill&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of North Carolina at Charlotte&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of North Carolina at Greensboro&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Wake forest University&#39;</span><span class="p">,</span> <span class="s1">&#39;Bellevue University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Creighton University&#39;</span><span class="p">,</span> <span class="s1">&#39;Nebraska College of Technical Agriculture&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Nebraska at Omaha&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Southern New Hampshire University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;New Jersey Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Rutgers University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Saint Peters University&#39;</span><span class="p">,</span> <span class="s1">&#39;Stevens Institute of Technology&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Thomas Edison State College&#39;</span><span class="p">,</span> <span class="s1">&#39;University of NevadaReno&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Columbia University in the City of New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Cornell University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;CUNY Bernard M Baruch College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;CUNY Graduate School and University Center&#39;</span><span class="p">,</span> <span class="s1">&#39;CUNY Queens College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Fordham University&#39;</span><span class="p">,</span> <span class="s1">&#39;Keller Graduate School of Management&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Marist College&#39;</span><span class="p">,</span> <span class="s1">&#39;New York University&#39;</span><span class="p">,</span> <span class="s1">&#39;Pace UniversityNew York&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Rensselaer Polytechnic Institute&#39;</span><span class="p">,</span> <span class="s1">&#39;St Johns UniversityNew York&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Syracuse University&#39;</span><span class="p">,</span> <span class="s1">&#39;The New School&#39;</span><span class="p">,</span> <span class="s1">&#39;Trocaire College&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Union Graduate College&#39;</span><span class="p">,</span> <span class="s1">&#39;University at Buffalo&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Rochester&#39;</span><span class="p">,</span> <span class="s1">&#39;Bowling Green State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Case Western Reserve University&#39;</span><span class="p">,</span> <span class="s1">&#39;Cleveland State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Miami University of Ohio&#39;</span><span class="p">,</span> <span class="s1">&#39;Notre Dame College&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The Ohio State University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of CincinnatiMain Campus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Oklahoma State University Center for Health Sciences&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Southwestern Oklahoma State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Oklahoma Norman Campus&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Albright College&#39;</span><span class="p">,</span> <span class="s1">&#39;Carnegie Mellon University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Drexel University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Harrisburg University of Science and Technology&#39;</span><span class="p">,</span>
       <span class="s1">&#39;La Salle University&#39;</span><span class="p">,</span> <span class="s1">&#39;Misericordia University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Pennsylvania State University&#39;</span><span class="p">,</span> <span class="s1">&#39;Philadelphia University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Saint Josephs University&#39;</span><span class="p">,</span> <span class="s1">&#39;Temple University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of PittsburghBradford&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of PittsburghPittsburgh Campus&#39;</span><span class="p">,</span> <span class="s1">&#39;Villanova University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Brown University&#39;</span><span class="p">,</span> <span class="s1">&#39;College of Charleston&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Medical University of South Carolina&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of South CarolinaColumbia&#39;</span><span class="p">,</span> <span class="s1">&#39;Dakota State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;South Dakota State University&#39;</span><span class="p">,</span> <span class="s1">&#39;Austin Peay State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Middle Tennessee State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Tennessee Technological University&#39;</span><span class="p">,</span> <span class="s1">&#39;The University of Tennessee&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The University of Tennessee at Chattanooga&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Memphis&#39;</span><span class="p">,</span> <span class="s1">&#39;Southern Methodist University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;St Marys University&#39;</span><span class="p">,</span> <span class="s1">&#39;Tarleton State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Texas A  M UniversityCollege Station&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The University of Texas at Austin&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The University of Texas at Dallas&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The University of Texas at San Antonio&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Dallas&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of North Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Utah&#39;</span><span class="p">,</span>
       <span class="s1">&#39;George Mason University&#39;</span><span class="p">,</span> <span class="s1">&#39;Radford University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Virginia&#39;</span><span class="p">,</span> <span class="s1">&#39;Virginia Commonwealth University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Virginia Polytechnic Institute and State University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Statisticscom&#39;</span><span class="p">,</span> <span class="s1">&#39;Bellevue College&#39;</span><span class="p">,</span> <span class="s1">&#39;City University of Seattle&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Seattle University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of WashingtonSeattle Campus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of WashingtonTacoma Campus&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of WisconsinMadison&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Wisconsin Colleges&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of WisconsinMilwaukee&#39;</span><span class="p">,</span> <span class="s1">&#39;West Virginia University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Ukrainian Catholic Univeristy&#39;</span><span class="p">,</span> <span class="s1">&#39;Sabanc University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;National University of Singapore&#39;</span><span class="p">,</span> <span class="s1">&#39;Dalarna University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Blekinge Institute of Technology&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Kth Royal Institute Of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Linkping University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Universidade Nova de Lisboa&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Otago&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Massey University&#39;</span><span class="p">,</span> <span class="s1">&#39;Erasmus University&#39;</span><span class="p">,</span> <span class="s1">&#39;Maastricht University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Radboud Universiteit Nijmegen&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Eindhoven University of TechnologyTUe&#39;</span><span class="p">,</span> <span class="s1">&#39;Utrecht University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Vrije Universiteit Amsterdam&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Autonomous Technological Institute of Mexico&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Mykolas Romeris University&#39;</span><span class="p">,</span> <span class="s1">&#39;Sangmyung University&#39;</span><span class="p">,</span> <span class="s1">&#39;BAICR&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Polytechnic University Of Turin&#39;</span><span class="p">,</span> <span class="s1">&#39;University Of MilanBicocca&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Pisa&#39;</span><span class="p">,</span> <span class="s1">&#39;BenGurion University Of The Negev&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Dublin City University&#39;</span><span class="p">,</span> <span class="s1">&#39;Dublin Institute Of Technology&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Institute Of Technology Blanchardstown&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Irish Management Institute&#39;</span><span class="p">,</span> <span class="s1">&#39;National College Of Ireland&#39;</span><span class="p">,</span>
       <span class="s1">&#39;National University Of Ireland Galway&#39;</span><span class="p">,</span> <span class="s1">&#39;University College Cork&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University College Dublin&#39;</span><span class="p">,</span> <span class="s1">&#39;Chinese University of Hong Kong&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Hong Kong University of Science  Technology&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Lancaster University&#39;</span><span class="p">,</span> <span class="s1">&#39;Aston University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Birmingham City University&#39;</span><span class="p">,</span> <span class="s1">&#39;Bournemouth University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Brunel University London&#39;</span><span class="p">,</span> <span class="s1">&#39;City University London&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Coventry University&#39;</span><span class="p">,</span> <span class="s1">&#39;De Montfort University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Goldsmiths University of London&#39;</span><span class="p">,</span> <span class="s1">&#39;Imperial College London&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Leeds Met&#39;</span><span class="p">,</span> <span class="s1">&#39;Newcastle University&#39;</span><span class="p">,</span> <span class="s1">&#39;Robert Gordon University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Royal Holloway University Of London&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Sheffield Hallam University&#39;</span><span class="p">,</span> <span class="s1">&#39;The University Of Edinburgh&#39;</span><span class="p">,</span>
       <span class="s1">&#39;The University Of Manchester&#39;</span><span class="p">,</span> <span class="s1">&#39;University College London&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Bristol&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Derby&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Dundee&#39;</span><span class="p">,</span> <span class="s1">&#39;University Of East Anglia&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of East London&#39;</span><span class="p">,</span> <span class="s1">&#39;University Of Essex&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Greenwich&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Kent&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Leeds&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Leicester&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Liverpool&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Manchester&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Nottingham&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Southampton&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of St Andrews&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Strathclyde&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Surrey&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Warwick&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Warwick&#39;</span><span class="p">,</span> <span class="s1">&#39;University Of Westminster&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Data ScienceTech Institute&#39;</span><span class="p">,</span> <span class="s1">&#39;EISTI&#39;</span><span class="p">,</span> <span class="s1">&#39;ENSAE Paris Tech&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Telecom Paris Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Telecom Sudparis&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Universit Pierre Et Marie Curie&#39;</span><span class="p">,</span> <span class="s1">&#39;Aalto University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University Of Helsinki&#39;</span><span class="p">,</span> <span class="s1">&#39;Universit De Nantes&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Barcelona School of Management&#39;</span><span class="p">,</span> <span class="s1">&#39;Instituto de Empresa&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Universidad Rey Juan Carlos&#39;</span><span class="p">,</span> <span class="s1">&#39;Universitat Pompeu Fabra&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Universities Of Alicante&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Barcelona&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Oviedo&#39;</span><span class="p">,</span> <span class="s1">&#39;Aalborg University&#39;</span><span class="p">,</span> <span class="s1">&#39;Aarhus University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Technical University of Denmark&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Otto Von Guericke University Magdeburg&#39;</span><span class="p">,</span> <span class="s1">&#39;TU Dortmund&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Universitt Konstanz&#39;</span><span class="p">,</span> <span class="s1">&#39;Queens University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Simon Fraser University&#39;</span><span class="p">,</span> <span class="s1">&#39;University Of Alberta&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of the Fraser Valley&#39;</span><span class="p">,</span> <span class="s1">&#39;York University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Mackenzie Presbyterian Institute&#39;</span><span class="p">,</span> <span class="s1">&#39;Deakin University&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Macquarie University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of South Australia&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Technology Sydney&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Vienna University of Economics and Business&#39;</span><span class="p">,</span>
       <span class="s1">&#39;University of Vienna&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">programs</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">r&#39;[^a-zA-Z\s0-9]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">programs</span><span class="p">]</span>
</pre></div>


<p>fuzzy matching once again:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_for_master</span><span class="p">(</span><span class="n">university</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">program</span> <span class="ow">in</span> <span class="n">programs</span><span class="p">:</span>
        <span class="n">similarity</span> <span class="o">=</span> <span class="n">is_fuzzy_match</span><span class="p">(</span><span class="n">university</span><span class="p">,</span> <span class="n">program</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">similarity</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ds_master&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;university_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_for_master</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">universities_with_ds_program</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ds_master&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">universities_with_ds_program</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>university_name</th>
      <th>score_cwur</th>
      <th>score_shanghai</th>
      <th>score_times</th>
      <th>mean_score</th>
      <th>ds_master</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>184</th>
      <td>Harvard University</td>
      <td>9.184015</td>
      <td>5.038545</td>
      <td>4.299896</td>
      <td>6.174152</td>
      <td>True</td>
    </tr>
    <tr>
      <th>511</th>
      <td>Stanford University</td>
      <td>8.373695</td>
      <td>2.958663</td>
      <td>2.912832</td>
      <td>4.748397</td>
      <td>True</td>
    </tr>
    <tr>
      <th>627</th>
      <td>University of California Berkeley</td>
      <td>6.974484</td>
      <td>2.858890</td>
      <td>1.975279</td>
      <td>3.936218</td>
      <td>True</td>
    </tr>
    <tr>
      <th>648</th>
      <td>University of Chicago</td>
      <td>6.414454</td>
      <td>1.792785</td>
      <td>1.684167</td>
      <td>3.297135</td>
      <td>True</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Cornell University</td>
      <td>5.878549</td>
      <td>1.383925</td>
      <td>1.003478</td>
      <td>2.755317</td>
      <td>True</td>
    </tr>
    <tr>
      <th>242</th>
      <td>Johns Hopkins University</td>
      <td>3.814195</td>
      <td>0.917155</td>
      <td>1.191845</td>
      <td>1.974398</td>
      <td>True</td>
    </tr>
    <tr>
      <th>207</th>
      <td>Imperial College London</td>
      <td>1.978591</td>
      <td>NaN</td>
      <td>1.851128</td>
      <td>1.914860</td>
      <td>True</td>
    </tr>
    <tr>
      <th>762</th>
      <td>University of Michigan Ann Arbor</td>
      <td>2.554990</td>
      <td>0.738075</td>
      <td>NaN</td>
      <td>1.646533</td>
      <td>True</td>
    </tr>
    <tr>
      <th>879</th>
      <td>University of St Andrews</td>
      <td>-0.117642</td>
      <td>NaN</td>
      <td>3.066950</td>
      <td>1.474654</td>
      <td>True</td>
    </tr>
    <tr>
      <th>633</th>
      <td>University of California San Diego</td>
      <td>3.203763</td>
      <td>1.200426</td>
      <td>-0.032539</td>
      <td>1.457217</td>
      <td>True</td>
    </tr>
    <tr>
      <th>944</th>
      <td>University of WisconsinMadison</td>
      <td>2.673889</td>
      <td>0.889247</td>
      <td>0.155828</td>
      <td>1.239654</td>
      <td>True</td>
    </tr>
    <tr>
      <th>571</th>
      <td>University College London</td>
      <td>2.055703</td>
      <td>0.712027</td>
      <td>0.669555</td>
      <td>1.145762</td>
      <td>True</td>
    </tr>
    <tr>
      <th>379</th>
      <td>New York University</td>
      <td>3.377803</td>
      <td>0.334565</td>
      <td>-0.332213</td>
      <td>1.126718</td>
      <td>True</td>
    </tr>
    <tr>
      <th>713</th>
      <td>University of Illinois at UrbanaChampaign</td>
      <td>2.298239</td>
      <td>0.568996</td>
      <td>0.194357</td>
      <td>1.020531</td>
      <td>True</td>
    </tr>
    <tr>
      <th>394</th>
      <td>Northwestern University</td>
      <td>2.431784</td>
      <td>NaN</td>
      <td>-0.691823</td>
      <td>0.869981</td>
      <td>True</td>
    </tr>
    <tr>
      <th>530</th>
      <td>Technical University of Denmark</td>
      <td>0.226992</td>
      <td>NaN</td>
      <td>1.440146</td>
      <td>0.833569</td>
      <td>True</td>
    </tr>
    <tr>
      <th>901</th>
      <td>University of Texas at Austin</td>
      <td>2.187956</td>
      <td>0.033153</td>
      <td>0.224325</td>
      <td>0.815144</td>
      <td>True</td>
    </tr>
    <tr>
      <th>457</th>
      <td>Royal Institute of Technology</td>
      <td>0.643998</td>
      <td>NaN</td>
      <td>0.926419</td>
      <td>0.785208</td>
      <td>True</td>
    </tr>
    <tr>
      <th>584</th>
      <td>University of Alberta</td>
      <td>0.337274</td>
      <td>NaN</td>
      <td>1.089099</td>
      <td>0.713187</td>
      <td>True</td>
    </tr>
    <tr>
      <th>597</th>
      <td>University of Barcelona</td>
      <td>0.564732</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.564732</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="n">universities_with_ds_program</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;DSDegrees.csv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>


<h2>further steps</h2>
<ul>
<li>improve fuzzy string matching (especially functions)</li>
<li>use more information than just total score</li>
<li>use weights to include personal preference</li>
</ul>
<div class="highlight"><pre><span></span>
</pre></div>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>